<!doctype html>
<html>
  <head>
    <meta charset = 'utf-8' />
  </head>
  <body>
    <input id = 'keywords' type = '' />
    <button id = 'copyButton'>コピー</button>
    <script>
function onCopy (event) {
  const keyword = keywords.value.split(' ').map(keyword => keyword.startsWith('#') ? keyword : `#${keyword}`).join(' ');
  const url = `https://teams.microsoft.com/_#/apps/search?q=${encodeURIComponent(keyword)}`;
  event.clipboardData.setData('text/html',`<a href = '${url}'>${keyword}</a>`);
  event.clipboardData.setData('text/plain', keyword);
  event.preventDefault();
  document.removeEventListener('copy', onCopy, false);
}
copyButton.addEventListener('click', function (event) {
  document.addEventListener('copy', onCopy, false);
  document.execCommand('copy');
}, false);
    </script>
  </body>
</html>
